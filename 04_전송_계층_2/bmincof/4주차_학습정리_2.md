# 08. Transport-Layer 4

## **TCP Congestion Control**
데이터 이동 경로 중 전송할 수 있는 한계가 가장 낮은 곳에 맞춰야 함.

그런데 내부 네트워크 상태가 어떨지 모름 -> 1개 데이터부터 점차적으로 늘려나가보는 방식으로 전송 속도 올리기 (**Slow start**)

Slow Start방식 덕분에 안전한 것은 맞지만 매 데이터의 개수를 1씩 증가시키면 너무 느림, 그래서 매 전송마다 **2배씩 증가**시킴

**Threshold부터 증가량을 Linear하게** 변경(특정 수준 이상부터는 전송량을 막 늘리면 위험해질 수 있음, **Additive increase**) 

-> linear하게 증가시키다가 **문제(패킷 유실)가 생기면 전송량을 절반**으로 줄임 (네트워크는 공유자원이고 한 번 막히면 한 번에 크게 줄여야 막힌 것이 해결됨, **Multiplicative decrease**)

**Maximum Segment Size(MSS) :**

 한 세그먼트는 최대 500바이트의 크기를 가질 수 있음. 위에서 말한 데이터의 개수가 MSS (처음 윈도우 사이즈 1 MSS ~ 증가)

윈도우 사이즈 = 전송 속도, Additive increase 중에 패킷 유실이 탐지되면 절반으로 줄이기

계속 늘렸다 줄였다 하지말고 문제없는 수준으로 계속 보내는게 낫지 않은지?
-> 계속해서 네트워크 상태가 변하고 어느정도가 적정한 수준인지 판단이 불가능함

RTT : 라우팅 타임 (데이터 전송 + 응답 시간 = 왕복 시간)
rate = CongWin / RTT -> 결국 Congestion window size가 네트워크에 영향을 미치고 전송 속도에 영향을 미침

## **문제 상황 비교**

**timeout 또는 3 dup ACK이 일어나면 패킷 유실**로 생각

3 dup ACK를 받은 상황 : 나머지는 다 잘 갔는데 하나만 제대로 안 간 상황

timeout : 전부 다 제대로 안 간 상황
-> 더 심각한 상황

=> **3 dup ACK이면 완전히 발을 뺄 필요는 없음**

TCP 1 Tahoe 는 두 경우 모두 1로 초기화, TCP 2 Reno는 timeout일 때 1, 3 dup ACK일 때 절반으로 변경

**Threshold는** 어떻게 설정할까? **패킷 로스가 발생한 순간의 절반**으로

여태까지는 end-to-end만 고려했지만 실제로는 여러 명이 TCP통신을 동시에 독립적으로 진행함
-> 여러 사람들이 네트워크 자원을 공평하게 사용하는가?

## **TCP Fairness**
만약 2명이 동시에 사용한다면 위와 같은 congestion control 상황에서 네트워크 자원(bandwidth)을 절반씩 쓰게 되는가? -> 가능하다

단, TCP 커넥션마다 공평한 것이기 때문에 한 명이 여러 개의 커넥션을 사용하면 다른 사람보다 자원을 많이 사용하는 것
